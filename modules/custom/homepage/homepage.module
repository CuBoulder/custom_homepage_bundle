<?php

/**
 * Preprocess html.
 */
function homepage_preprocess_html(&$vars) {
  // Only allow Same Origin to iframe us.
  $meta = array(
    '#type' => 'html_tag',
    '#tag' => 'meta',
    '#attributes' => array(
      'content' => 'SAMEORIGIN',
      'http-equiv' => 'X-Frame-Options',
    ),
  );
  drupal_add_html_head($meta, 'homepage_xframe_options');
  drupal_add_http_header('X-Frame-Options', 'SAMEORIGIN');
}

/**
 * Implements hook_enable().
 */
function homepage_enable() {
  return array(
    'homepage_secure_permissions' => array(),
    'homepage_secure_permissions_roles' => array(),
  );
}


/**
 * Implements hook_secure_permissions_roles().
 *
 * Create a secure_permissions_data module directory and place this function
 * in secure_permissions_data.module.
 *
 * @return
 *   An array defining all the roles for the site.
 */
function homepage_secure_permissions_roles() {
  return array(
    'blogger',
  );
}

/**
 * Implements hook_secure_permissions().
 */
function homepage_secure_permissions($role) {
   $permissions = array(
    'administrator' => array(
      'administer admission_event_series vocabulary terms',
      'administer admission_event_type vocabulary terms',
      'access_google_appliance_content',
      'administer admission_recruitment_location vocabulary terms',
      'administer audience vocabulary terms',
      'administer blog_post_tags vocabulary terms',
      'administer career_interests vocabulary terms',
      'administer categories vocabulary terms',
      'administer college_school vocabulary terms',
      'administer degrees_offered vocabulary terms',
      'administer policy_categories vocabulary terms',
      'administer resource_category vocabulary terms',
      'administer resource_sub_category vocabulary terms',
      'assign blogger role',
      'create admission_event content',
      'create any resources bean',
      'create blog_post content',
      'create degree_program content',
      'create policy content',
      'create resource content',
      'delete any admission_event content',
      'delete any blog_post content',
      'delete any degree_program content',
      'delete any policy content',
      'delete any resource content',
      'delete any resources bean',
      'delete own admission_event content',
      'delete own blog_post content',
      'delete own degree_program content',
      'delete own policy content',
      'delete own resource content',
      'delete terms in 12',
      'delete terms in 14',
      'delete terms in 16',
      'delete terms in 18',
      'delete terms in 20',
      'delete terms in 22',
      'delete terms in 24',
      'delete terms in 26',
      'delete terms in 28',
      'delete terms in 30',
      'delete terms in 31',
      'delete terms in 32',
      'edit any admission_event content',
      'edit any blog_post content',
      'edit any degree_program content',
      'edit any policy content',
      'edit any resource content',
      'edit any resources bean',
      'edit own admission_event content',
      'edit own blog_post content',
      'edit own degree_program content',
      'edit own policy content',
      'edit own resource content',
      'edit terms in 12',
      'edit terms in 14',
      'edit terms in 16',
      'edit terms in 18',
      'edit terms in 20',
      'edit terms in 22',
      'edit terms in 24',
      'edit terms in 26',
      'edit terms in 28',
      'edit terms in 30',
      'edit terms in 31',
      'edit terms in 32',
      'merge terms',
      'view any resources bean',
      'view atoz',
      'view_cu_search_homepage_results',
    ),
    'anonymous user' => array(
      'access_google_appliance_content',
      'view any resources bean',
      'view atoz',
      'view_cu_search_homepage_results',
    ),
    'authenticated user' => array(
      'access_google_appliance_content',
      'view any resources bean',
      'view atoz',
      'view_cu_search_homepage_results',
    ),
    'blogger' => array(
      'access_google_appliance_content',
      'access content overview',
      'create blog_post content',
      'delete own blog_post content',
      'delete revisions',
      'edit own blog_post content',
      'edit own person content',
      'preview focal point',
      'revert revisions',
      'use text format wysiwyg',
      'view any articles bean',
      'view any article_grid bean',
      'view any article_slider bean',
      'view any cu_events_calendar_block bean',
      'view any events_calendar_grid bean',
      'view any facebook_activity bean',
      'view any facebook_like_button bean',
      'view any hero_unit bean',
      'view any resources bean',
      'view any slider bean',
      'view any twitter_block bean',
      'view own unpublished content',
      'view revisions',
      'view the administration theme',
      'view atoz',
      'view_cu_search_homepage_results',
    ),
    'content_editor' => array(
      'access_google_appliance_content',
      'administer admission_recruitment_location vocabulary terms',
      'administer blog_post_tags vocabulary terms',
      'administer career_interests vocabulary terms',
      'administer categories vocabulary terms',
      'administer college_school vocabulary terms',
      'administer degrees_offered vocabulary terms',
      'administer policy_categories vocabulary terms',
      'administer resource_category vocabulary terms',
      'administer resource_sub_category vocabulary terms',
      'create admission_event content',
      'create any resources bean',
      'create blog_post content',
      'create degree_program content',
      'create policy content',
      'create resource content',
      'delete any admission_event content',
      'delete any blog_post content',
      'delete any degree_program content',
      'delete any policy content',
      'delete any resource content',
      'delete any resources bean',
      'delete own admission_event content',
      'delete own blog_post content',
      'delete own degree_program content',
      'delete own policy content',
      'delete own resource content',
      'delete own resources bean',
      'delete terms in 12',
      'delete terms in 14',
      'delete terms in 16',
      'delete terms in 18',
      'delete terms in 20',
      'delete terms in 22',
      'delete terms in 24',
      'delete terms in 26',
      'delete terms in 28',
      'edit any admission_event content',
      'edit any blog_post content',
      'edit any degree_program content',
      'edit any policy content',
      'edit any resource content',
      'edit any resources bean',
      'edit own admission_event content',
      'edit own blog_post content',
      'edit own degree_program content',
      'edit own policy content',
      'edit own resource content',
      'edit own resources bean',
      'edit terms in 12',
      'edit terms in 14',
      'edit terms in 16',
      'edit terms in 18',
      'edit terms in 20',
      'edit terms in 22',
      'edit terms in 24',
      'edit terms in 26',
      'edit terms in 28',
      'merge terms',
      'view any resources bean',
      'view atoz',
      'view_cu_search_homepage_results',
    ),
    'developer' => array(
      'administer admission_event_series vocabulary terms',
      'administer admission_event_type vocabulary terms',
      'access_google_appliance_content',
      'administer_google_appliance',
      'administer admission_recruitment_location vocabulary terms',
      'administer audience vocabulary terms',
      'administer blog_post_tags vocabulary terms',
      'administer career_interests vocabulary terms',
      'administer categories vocabulary terms',
      'administer college_school vocabulary terms',
      'administer degrees_offered vocabulary terms',
      'administer feeds',
      'administer feeds_tamper',
      'administer policy_categories vocabulary terms',
      'administer postal code',
      'administer resource_category vocabulary terms',
      'administer resource_sub_category vocabulary terms',
      'assign blogger role',
      'clear admission_event feeds',
      'clear admission_recruitment_locations feeds',
      'clear admission_recruitment_locations_high_school feeds',
      'clear admission_recruitment_locations_region feeds',
      'clear admission_recruitment_locations_state feeds',
      'clear person_admission_recruitment_location feeds',
      'create admission_event content',
      'create any resources bean',
      'create blog_post content',
      'create degree_program content',
      'create policy content',
      'create resource content',
      'delete any admission_event content',
      'delete any blog_post content',
      'delete any degree_program content',
      'delete any policy content',
      'delete any resource content',
      'delete any resources bean',
      'delete own admission_event content',
      'delete own blog_post content',
      'delete own degree_program content',
      'delete own policy content',
      'delete own resource content',
      'delete own resources bean',
      'delete terms in 12',
      'delete terms in 14',
      'delete terms in 16',
      'delete terms in 18',
      'delete terms in 20',
      'delete terms in 22',
      'delete terms in 24',
      'delete terms in 26',
      'delete terms in 28',
      'delete terms in 30',
      'delete terms in 31',
      'delete terms in 32',
      'edit any admission_event content',
      'edit any blog_post content',
      'edit any degree_program content',
      'edit any policy content',
      'edit any resource content',
      'edit any resources bean',
      'edit own admission_event content',
      'edit own blog_post content',
      'edit own degree_program content',
      'edit own policy content',
      'edit own resource content',
      'edit own resources bean',
      'edit terms in 12',
      'edit terms in 14',
      'edit terms in 16',
      'edit terms in 18',
      'edit terms in 20',
      'edit terms in 22',
      'edit terms in 24',
      'edit terms in 26',
      'edit terms in 28',
      'edit terms in 30',
      'edit terms in 31',
      'edit terms in 32',
      'import admission_event feeds',
      'import admission_recruitment_locations feeds',
      'import admission_recruitment_locations_high_school feeds',
      'import admission_recruitment_locations_region feeds',
      'import admission_recruitment_locations_state feeds',
      'import person_admission_recruitment_location feeds',
      'merge terms',
      'tamper admission_event',
      'tamper admission_recruitment_locations',
      'tamper admission_recruitment_locations_high_school',
      'tamper admission_recruitment_locations_region',
      'tamper admission_recruitment_locations_state',
      'tamper person_admission_recruitment_location',
      'unlock admission_event feeds',
      'unlock admission_recruitment_locations feeds',
      'unlock admission_recruitment_locations_high_school feeds',
      'unlock admission_recruitment_locations_region feeds',
      'unlock admission_recruitment_locations_state feeds',
      'unlock person_admission_recruitment_location feeds',
      'view any resources bean',
      'view atoz',
      'view_cu_search_homepage_results',
    ),
    'site_owner' => array(
      'administer admission_event_series vocabulary terms',
      'administer admission_event_type vocabulary terms',
      'access_google_appliance_content',
      'administer admission_recruitment_location vocabulary terms',
      'administer audience vocabulary terms',
      'administer blog_post_tags vocabulary terms',
      'administer career_interests vocabulary terms',
      'administer categories vocabulary terms',
      'administer college_school vocabulary terms',
      'administer degrees_offered vocabulary terms',
      'administer policy_categories vocabulary terms',
      'administer resource_category vocabulary terms',
      'administer resource_sub_category vocabulary terms',
      'assign blogger role',
      'clear admission_event feeds',
      'create admission_event content',
      'create any resources bean',
      'create blog_post content',
      'create degree_program content',
      'create policy content',
      'create resource content',
      'delete any admission_event content',
      'delete any blog_post content',
      'delete any degree_program content',
      'delete any policy content',
      'delete any resource content',
      'delete any resources bean',
      'delete own admission_event content',
      'delete own blog_post content',
      'delete own degree_program content',
      'delete own policy content',
      'delete own resource content',
      'delete terms in 12',
      'delete terms in 14',
      'delete terms in 16',
      'delete terms in 18',
      'delete terms in 20',
      'delete terms in 22',
      'delete terms in 24',
      'delete terms in 26',
      'delete terms in 28',
      'delete terms in 30',
      'delete terms in 31',
      'delete terms in 32',
      'edit any admission_event content',
      'edit any blog_post content',
      'edit any degree_program content',
      'edit any policy content',
      'edit any resource content',
      'edit any resources bean',
      'edit own admission_event content',
      'edit own blog_post content',
      'edit own degree_program content',
      'edit own policy content',
      'edit own resource content',
      'edit terms in 12',
      'edit terms in 14',
      'edit terms in 16',
      'edit terms in 18',
      'edit terms in 20',
      'edit terms in 22',
      'edit terms in 24',
      'edit terms in 26',
      'edit terms in 28',
      'edit terms in 30',
      'edit terms in 31',
      'edit terms in 32',
      'import admission_event feeds',
      'merge terms',
      'unlock admission_recruitment_locations feeds',
      'view any resources bean',
      'view atoz',
      'view_cu_search_homepage_results',
    ),
  );
  if (isset($permissions[$role])) {
    return $permissions[$role];
  }
}
